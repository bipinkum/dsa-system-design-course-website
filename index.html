<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bipin Kumar - DSA & System Design Course</title>
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin:0; background-color:#f5f7fa; color:#222; line-height:1.6; }
    .navbar { display:flex; justify-content:center; padding:20px 0; background-color:white; box-shadow:0 2px 10px rgba(0,0,0,0.1); position:fixed; width:100%; top:0; z-index:100; }
    .nav-item { margin:0 30px; font-size:20px; font-weight:bold; cursor:pointer; color:#333; transition:color 0.3s ease; }
    .nav-item:hover, .nav-item.active { color:#d9534f; }
    .container { padding-top:100px; text-align:center; }
    .header { font-size:36px; font-weight:700; margin-bottom:10px; }
    .subheader { font-size:20px; color:#666; margin-bottom:50px; }
    .course-container { display:flex; justify-content:center; gap:30px; flex-wrap:wrap; padding:30px; }
    .course-card { background:white; padding:30px; width:360px; box-shadow:0px 4px 20px rgba(0,0,0,0.1); border-radius:15px; text-align:left; transition: transform 0.2s ease, box-shadow 0.2s ease; }
    .course-card:hover { transform:translateY(-5px); box-shadow:0px 6px 24px rgba(0,0,0,0.15); }
    .course-card h2 { font-size:24px; margin-bottom:15px; }
    .course-card p { font-size:18px; color:#444; }
    .details-button { display:inline-block; margin-top:15px; padding:10px 20px; background:#d9534f; color:white; text-decoration:none; border-radius:6px; font-size:16px; }
    #magic-login-section { margin:40px auto; text-align:center; }
    #magic-login-section input { padding:8px; width:250px; margin-right:10px; }
    #magic-login-section button { padding:8px 12px; }
    #loginStatus { margin-top:10px; }
    video { border-radius: 8px; margin-top:10px; }
  </style>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5HVZ9VG7YQ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-5HVZ9VG7YQ');
  </script>
</head>
<body>

  <!-- Navbar -->
  <div class="navbar">
    <div class="nav-item" onclick="showTab(event,'bipin')">Bipin Kumar</div>
    <div class="nav-item active" onclick="showTab(event,'courses')">Courses</div>
    <div class="nav-item" onclick="showTab(event,'teaching')">Teaching Style</div>
    <div class="nav-item" onclick="showTab(event,'payment')">Payment</div>
    <div class="nav-item" onclick="showTab(event,'studentDashboard')">Student Dashboard</div>
  </div>

  <!-- Bipin intro -->
  <div id="bipin" class="container" style="display:none;">
    <h1>Hello, I am Bipin</h1>
    <p>Senior Principal Software Engineer & Engineering Leader, passionate about teaching DSA & System Design.</p>
  </div>

  <!-- Courses tab -->
  <div id="courses" class="container">
    <div class="course-container">
      <div class="course-card">
        <h2>Data Structure and Algorithm</h2>
        <p>Master DSA from fundamentals to advanced, mentor-led, with interview focus.</p>
        <a href="https://github.com/bipinkum/DSA-Course" target="_blank" class="details-button">Details →</a>
      </div>
      <div class="course-card">
        <h2>System Design</h2>
        <p>Learn scalable, fault-tolerant system design with real-world use cases.</p>
        <a href="https://github.com/bipinkum/System-Design-Course" target="_blank" class="details-button">Details →</a>
      </div>
    </div>
  </div>

  <!-- Teaching Style -->
  <div id="teaching" class="container" style="display:none;">
    <h2>Teaching Style</h2>
    <p>Mentor-led, real-world examples, hands-on exercises.</p>
  </div>

  <!-- Payment -->
  <div id="payment" class="container" style="display:none;">
    <h2>Pay for the Course</h2>
    <a href="https://rzp.io/rzp/fhbHRyTK" target="_blank" class="details-button">Pay Now → ₹35,000</a>
  </div>

  <!-- Student Dashboard with magic link form -->
  <div id="studentDashboard" class="container" style="display:none;">
    <h2>Student Dashboard</h2>

    <div id="magic-login-section">
      <input type="email" id="studentEmail" placeholder="Enter your email" />
      <button id="getMagicLinkBtn">Get Magic Link</button>
      <div id="loginStatus"></div>
    </div>

    <div id="coursesContainer" class="course-container"></div>
  </div>

  <script>
    function showTab(event, tabId) {
      document.querySelectorAll('.container').forEach(tab => tab.style.display='none');
      document.getElementById(tabId).style.display='block';
      document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
      event.target.classList.add('active');

      if(tabId==='studentDashboard') loadStudentCourses();
    }

    window.onload = function() {
      showTab({target:document.querySelector('.nav-item.active')},'courses');
    };

    // Magic link login
    const emailInput = document.getElementById('studentEmail');
    const loginStatus = document.getElementById('loginStatus');
    const getMagicLinkBtn = document.getElementById('getMagicLinkBtn');

    getMagicLinkBtn.addEventListener('click', async () => {
      const email = emailInput.value.trim();
      if(!email){ loginStatus.style.color='red'; loginStatus.innerText='Please enter your email'; return; }

      loginStatus.style.color='black';
      loginStatus.innerText='Sending magic link...';

      try{
        const res = await fetch('https://dsa-system-design-course-website.onrender.com/auth/login',{
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({email})
        });
        const data = await res.json();
        if(res.ok){ loginStatus.style.color='green'; loginStatus.innerText='✅ Magic link sent! Check your email.'; }
        else{ loginStatus.style.color='red'; loginStatus.innerText=`❌ ${data.error}`; }
      } catch(err){ console.error(err); loginStatus.style.color='red'; loginStatus.innerText='❌ Failed to send magic link.'; }
    });

    // Load student courses after magic link login (HTTP-only cookie)
    async function loadStudentCourses(){
      try{
        const res = await fetch('https://dsa-system-design-course-website.onrender.com/api/student-courses',{
          credentials:'include'
        });
        if(!res.ok) return;
        const data = await res.json();
        const container = document.getElementById('coursesContainer');
        container.innerHTML='';
        data.courses.forEach(course => {
          const div = document.createElement('div');
          div.className='course-card';
          div.innerHTML = `<h2>${course.name}</h2><video src="${course.videoUrl}" controls width="100%"></video>`;
          container.appendChild(div);
        });
      } catch(err){ console.error('Error fetching courses:',err); }
    }
  </script>

</body>
</html>
